import datetime
import sqlite3
import random
import telebot

current_datetime = datetime.datetime.now()
sp = ""
sp += (
    str(current_datetime.day)
    + " "
    + str(current_datetime.month)
    + " "
    + str(current_datetime.year)
)
connection = sqlite3.connect("jelania.db")

cursor_object = connection.execute(
    """
    CREATE TABLE IF NOT EXISTS jelanis(
        order_id INTEGER PRIMARY KEY,
        chat_id INTEGER,
        jelania TEXT,
        data TEXT
    )
  """
)
a = (
    "–í —ç—Ç–æ–º –≥–æ–¥—É —Ç—ã —Ç–æ—á–Ω–æ –±—É–¥–µ—à—å —Å –¥—Ä—É–∑—å—è–º–∏ –Ω–∞ –æ–¥–Ω–æ–π –≤–æ–ª–Ω–µ! –ê –µ—â—ë - –≤ –æ–¥–Ω–æ–π WiFi-—Å–µ—Ç–∏, –∫–æ–≥–¥–∞ –≤—ã –≤–º–µ—Å—Ç–µ –ø—Ä–∏–¥–µ—Ç–µ –Ω–∞ –∑–∞–Ω—è—Ç–∏—è –≤ —à–∫–æ–ª—É Movavi.\n"
    "–ê–∫—Ç–∏–≤–∏—Ä—É–µ–º IT-–∏–Ω—Ç—É–∏—Ü–∏—é: –≤ –Ω–∞—Å—Ç—É–ø–∞—é—â–µ–º –≥–æ–¥—É —Ç—ã —Å–º–æ–∂–µ—à—å —Å–æ–∑–¥–∞—Ç—å —Å–∞–º—ã–π –∫—Ä—É—Ç–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–≤–æ–µ–º –∫—É—Ä—Å–µ!\n"
    "–ü–æ–¥—Ö–æ–¥—è—â–∏–π –≥–æ–¥ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–µ–ª! –î–∞–∂–µ —Å–∞–º—ã–µ —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∫–∏ –Ω–µ —É—Å—Ç–æ—è—Ç –ø–µ—Ä–µ–¥ —Ç–≤–æ–∏–º —ç–Ω—Ç—É–∑–∏–∞–∑–º–æ–º ‚òÄÔ∏è\n"
    '–£ —Ç–µ–±—è –ø–æ—è–≤–∏—Ç—Å—è –æ—Å–æ–±—ã–π "—Ö–∞–∫–µ—Ä—Å–∫–∏–π" –Ω–∞–≤—ã–∫ ‚Äî —É–º–µ–Ω–∏–µ —É–∑–Ω–∞–≤–∞—Ç—å, –∫—Ç–æ —Å—ä–µ–ª –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–µ—á–µ–Ω—å–µ, –ø–æ –æ–¥–Ω–æ–º—É –≤–∑–≥–ª—è–¥—É –Ω–∞ –æ–¥–Ω–æ–≥—Ä—É–ø–ø–Ω–∏–∫–æ–≤. \n'
    "–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–±–µ —É—Ä–æ–∂–∞–π –Ω–æ–≤—ã—Ö —É–º–µ–Ω–∏–π, –∫—Ä—É—Ç—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ ‚Äî –∏ –º–Ω–æ–≥–æ-–º–Ω–æ–≥–æ-–º–Ω–æ–≥–æ —Å–∞–º—ã—Ö –ª—é–±–∏–º—ã—Ö –ø–µ—á–µ–Ω–µ–∫ üç™\n"
    "–ë—É–¥–µ—Ç –º–Ω–æ–≥–æ –∫—Ä—É—Ç—ã—Ö –∫–∞—Ç–æ–∫ —Å –¥—Ä—É–∑—å—è–º–∏! –ù–æ –Ω–µ –∑–∞–±—ã–≤–∞–π –∏–Ω–æ–≥–¥–∞ –≤—ã–ø—É—Å–∫–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω –∏–∑ —Ä—É–∫. –ì–æ–≤–æ—Ä—è—Ç, –∫–∞—Ç–∞—Ç—å –Ω–∞ –ª—ã–∂–∞—Ö —Ç–æ–∂–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ. \n"
    "–í —ç—Ç–æ–º –≥–æ–¥—É –Ω–∞ –∑–∞–Ω—è—Ç–∏—è—Ö –≤ —à–∫–æ–ª–µ Movavi —É —Ç–µ–±—è –ø–æ—è–≤–∏—Ç—Å—è –∫—Ä—É—Ç–æ–π –¥—Ä—É–≥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–Ω–∏–º–∞—Ç—å –≤—Å–µ-–≤—Å–µ-–≤—Å–µ —Ç–≤–æ–∏ —à—É—Ç–∫–∏!\n"
    '–ù–∞—à–∏ "–¥–∞" –≤ –ª—é–¥—è—Ö - –±—ã—Ç—å –ø–æ—Ö–æ–∂–∏–º –Ω–∞ —Ç–µ–±—è! –ü–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã –æ—á–µ–Ω—å-–æ—á–µ–Ω—å –∫—Ä—É—Ç–æ–π :) –ü—É—Å—Ç—å —ç—Ç–æ—Ç –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å–µ—Ç —Ç–µ–±–µ –º–Ω–æ–≥–æ —Ä–∞–¥–æ—Å—Ç–∏! \n'
    "–ë–æ—Å—Å –∞–π—Ç–∏ - —ç—Ç–æ –ø—Ä–æ —Ç–µ–±—è. –î–∞-–¥–∞, –Ω–µ —Å–∫—Ä–æ–º–Ω–∏—á–∞–π :) –ñ–µ–ª–∞–µ–º –¥–æ–±–∏—Ç—å—Å—è –µ—â–µ –±–æ–ª—å—à–∏—Ö –≤—ã—Å–æ—Ç –≤ IT-–º–∏—Ä–µ, –∞ –º—ã —Ç–µ–±–µ –≤ —ç—Ç–æ–º –ø–æ–º–æ–∂–µ–º.\n"
    "–¢–≤–æ–∏ —É—Å–ø–µ—Ö–∏ –≤ –Ω–æ–≤–æ–º –≥–æ–¥—É –∑–∞–º–µ—Ç—è—Ç –≤—Å–µ –¥—Ä—É–∑—å—è - –∏ –∑–∞—Ö–æ—Ç—è—Ç –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Å —Ç–æ–±–æ–π –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ ü§©\n"
    "–ó–≤–µ–∑–¥—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –≤ –Ω–æ–≤–æ–º –≥–æ–¥—É —Ç—ã —Å–ø—Ä–∞–≤–∏—à—å—Å—è —Å–æ –≤—Å–µ–º–∏ –±–∞–≥–∞–º–∏!\n"
    "–¢–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–∑–ª–µ—Ç–∏—Ç –¥–æ –Ω–µ–±–µ—Å! –ñ–¥–∏ –ª–∞–≤–∏–Ω—É –≥–µ–Ω–∏–∞–ª—å–Ω—ã—Ö –∏–¥–µ–π –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–∏–≤—è—Ç –≤—Å–µ—Ö –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π.\n"
    "–í –≥—Ä—è–¥—É—â–µ–º –≥–æ–¥—É —Ç—ã –æ—Å–≤–æ–∏—à—å –Ω–æ–≤—ã–π IT-–Ω–∞–≤—ã–∫ —Ç–∞–∫ –∂–µ –ª–µ–≥–∫–æ, –∫–∞–∫ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—à—å –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∏!\n"
    "–°—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –ù–æ–≤–æ–≥–æ –ì–æ–¥–∞! –ü—É—Å—Ç—å –≤ —ç—Ç–æ–º –≥–æ–¥—É —Ç–µ–±—è –∂–¥—É—Ç –º–µ–≥–∞-–∫–∞–Ω–∏–∫—É–ª—ã —Å –ª—é–±–∏–º—ã–º–∏ –¥—Ä—É–∑—å—è–º–∏. –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤—ã –æ—Ç —ç–∫—Ä–∞–Ω–æ–≤ - –Ω–∞ —É–ª–∏—Ü–µ –æ—Ç–ª–∏—á–Ω–∞—è –ø–æ–≥–æ–¥–∞! \n"
    "–í –Ω–æ–≤–æ–º –≥–æ–¥—É —Ç—ã –æ–±—Ä–µ—Ç–µ—à—å —Å—É–ø–µ—Ä—Å–∏–ª—É: –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å —Å–∫—É—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏! \n"
    "–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º: —Ç–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã –≤–∑–æ—Ä–≤—É—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç! –ñ–¥–∏ –º–∏–ª–ª–∏–æ–Ω—ã –ª–∞–π–∫–æ–≤ –∏ —Ä–µ–ø–æ—Å—Ç–æ–≤. \n"
    "–í —ç—Ç–æ–º –≥–æ–¥—É —Ç–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã –±—É–¥—É—Ç –Ω–∞—Å—Ç–æ–ª—å–∫–æ –∫—Ä—É—Ç—ã–º–∏, —á—Ç–æ –¥–∞–∂–µ —Å–∞–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ Movavi –±—É–¥—É—Ç —Å—Ç–∞–≤–∏—Ç—å —Ç–µ–±–µ —Å–∞–º—ã–µ –≤—ã—Å–æ–∫–∏–µ –æ—Ü–µ–Ω–∫–∏!\n"
    "–¢—ã –Ω–∞—É—á–∏—à—å—Å—è —Ç–∞–∫ –±—ã—Å—Ç—Ä–æ –Ω–∞–±–∏—Ä–∞—Ç—å –∫–æ–¥, —á—Ç–æ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –±—É–¥–µ—Ç –∑–≤—É—á–∞—Ç—å –∫–∞–∫ –º—É–∑—ã–∫–∞ –¥–ª—è —É—à–µ–π —Ç–≤–æ–∏—Ö –æ–¥–Ω–æ–≥—Ä—É–ø–ø–Ω–∏–∫–æ–≤.\n"
    "–í —ç—Ç–æ–º –≥–æ–¥—É —Ç—ã —Å—Ç–∞–Ω–µ—à—å –Ω–∞—Å—Ç–æ—è—â–∏–º –≥—É—Ä—É –≤ –æ–±–ª–∞—Å—Ç–∏ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –±—É–¥–µ—à—å –ø–æ–º–æ–≥–∞—Ç—å –¥—Ä—É–∑—å—è–º –∑–∞—â–∏—â–∞—Ç—å —Å–≤–æ–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ—Ç —Ö–∞–∫–µ—Ä–æ–≤.\n"
    "–¢–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –±—É–¥—É—Ç —Ä–∞—Å—Ç–∏ —Ç–∞–∫ –±—ã—Å—Ç—Ä–æ, —á—Ç–æ —É–∂–µ —Å–æ–≤—Å–µ–º —Å–∫–æ—Ä–æ —Ç—ã —Å–º–æ–∂–µ—à—å –Ω–∞—á–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç–∞–ø!"
)

TOKEN = "7385654525:AAEVcKf7OpEcWHPy5uloizg7DNwivUQlXtw"
bot = telebot.TeleBot(TOKEN)
connection.close()


@bot.message_handler(commands=["start"])
def handle_start(message):
    k = telebot.types.InlineKeyboardMarkup()
    btn_get_photo = telebot.types.InlineKeyboardButton(
        "–•–æ—á—É –ø–æ–∂–µ–ª–∞–Ω–∏–µ", callback_data="0"
    )
    k.add(btn_get_photo)
    bot.send_message(
        message.chat.id,
        "–ü—Ä–∏–≤–µ—Ç!\n–° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º –≥–æ–¥–æ–º üéÑüéÖ\n–ó–∞—Ö–æ–¥–∏ –≤ —ç—Ç–æ—Ç –±–æ—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤–æ–µ IT-–ø–æ–∂–µ–ª–∞–Ω–∏–µ. ",
        reply_markup=k,
    )


@bot.callback_query_handler(func=lambda callback: True)
def handle_callback(callback):
    global a
    connection = sqlite3.connect("jelania.db")
    cursor_object = connection.execute(
        f"""
            SELECT jelania
            FROM jelanis
            WHERE chat_id = {callback.message.chat.id}
        """
    )
    # –¥–æ—Å—Ç–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º —Å–ø–∏—Å–æ–∫
    current_datetime = datetime.datetime.now()
    sp = ""
    sp += (
        str(current_datetime.day)
        + " "
        + str(current_datetime.month)
        + " "
        + str(current_datetime.year)
    )
    g = cursor_object.fetchall()
    connection.close()
    t = False
    if g == []:
        t = True
        g = a.split("\n")
        connection = sqlite3.connect("jelania.db")
        cursor_object = connection.execute(
            f"""
        INSERT INTO jelanis(chat_id, jelania, data) 
        VALUES ({callback.message.chat.id}, '{a}', '{sp}')
        """
        )
        connection.commit()
        connection.close()
    else:
        g = g[0][0].strip("\n").split("\n")
        print("******************", g)
    connection = sqlite3.connect("jelania.db")
    cursor_object = connection.execute(
        f"""
            SELECT data
            FROM jelanis
            WHERE chat_id = {callback.message.chat.id}
        """
    )
    sd = cursor_object.fetchall()[0][0]
    print(sd)
    if sp != sd or t:
        f = g[random.randint(0, len(g) - 1)]
        g.remove(f)
        s = "\n".join(g)
        print("#############", s)

        if len(s) == 0:
            s = a
        SQL_UPDATE_TABLE = f"""
        UPDATE jelanis
        SET jelania = '{s}', data = '{sp}'
        WHERE chat_id = {callback.message.chat.id}
        """
        connection.execute(SQL_UPDATE_TABLE)
        connection.commit()
        print(f)
        bot.send_message(callback.message.chat.id, f)
        connection.close()
    else:
        bot.send_message(
            callback.message.chat.id, "–≤—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏ –ø–æ–∂–µ–ª–∞–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞–≤—Ç—Ä–∞"
        )


bot.polling(non_stop=True, interval=1)
